## 33장 - 사례연구 : 비디오 판매
### 유스케이스 분석
- 단일 책임 원칙에 따르면 이들 네 엑터가 시스템이 변경되어야할 4가지 주요 원인
- 신규 기능을 추가하거나 변경해야한다면 반드시 이들 엑터중 하나에게 해당 기능을 제공하기 위해서임
- 특정 액터의 변경이 나머지 액터에게는 전혀 영향을 미치지 않게 해야함
- 중앙 점섬으로된 유스케이스는 추상유스케이이스

### 컴포넌트 아키텍처
- view, presenter, interactor, controller로 나누고 각 컴포넌트는 네 종류의 엑터에 따라 카테고리로 분리
- 각 컴포넌트는 jar 혹은 dll 파일에 해당
- 컴포넌트 단위로 분할하여 후에 변경되는 시스템의 상황에 맞게 컴포넌트의 조합으로 더 배포 방식 변경 가능

### 의존성 관리
- 모든 의존성은 경계선을 한 방향으로만 가로지르고 항상 더 높은 수준의 정책을 포함하는 컴포넌트를 향하게함

## 35장 - 빠져 있는 장
### 계층 기반 패키지
- 수평 계층형 아키텍처
- 기술적인 관점에서 해당 코다가 하는 일에 기반해 코드를 분할
- 처음 시작하기에는 계층형 아키텍처가 적함. 복잡함을 겪지 않고 무언가를 작동시켜주는 아주 빠른 방법
- 업무도메인에 대해 말해주지 않음 -> 나란히 놓고보면 웹, 서비스, 레파지토리로 구성된 모습이 비슷하기 때문

### 기능 기반 패키지
- 서로 연관된 기능, 도메인개념, Aggregate Root에 기반하여 나누는 방식
- 예를 들어 order, pay, search등과 같은 하나의 업무기능 기준으로 패키지에 속함
- 예를 들어 주문 조회하기 유스케이스가 변경 될 경우 order라는 패키지만 찾으면 되기 때문에 코드 변경시에 수월

### 포트와 어댑터
- 업무,도메인에 초점을 둔 코드가 프레임워크, DB같은 세부사항에서 독립적이며 분리된 아키텍처를 만들기 위함
- 외부가 내부에 의존하며, 절대 그반대는 안됨

### 컴포넌트 기반 패키지
- SOLID, REP, CCP, CRP 등 이 책에서 나온 여러 조언을 저자는 전적으로 동의하지만 '컴포넌트 기반 패키지'를 제시...
- 계층형 아키텍처를 다시 말하자면 계층형아키텍처는 의존성 화살표가 항상 아래로 향해야하고 각 계층은 반드시 바로 아래 계층에만 의존해야 함...이런 방식으로 깔끔한 비순환 의존성 그래프를 만들 수 있지만 코드베이스의 요소들이 서로 의존할 때는 몇가지 규칙을 반드시 지켜야함
그러나 속임수를 써서 몇몇 의존성을 의도치 않은 방식으로 추가하더라도 여전히 좋은 비순환 의존성 그래프가 완성됨.
- 웹 컨트롤러는 절대로 레파지토리에 직접 접근해서는 안 된다
- 서비스 중심적인 시각으로 소프트웨어 시스템을 바라보며, MSA가 가진 시각과도 동일

### 구현 세부사항엔 항상 문제가 있다.
- public지시자를 남발하면 java가 젱홍하는 캡슐화 관련 이점을 활용하지 않겠다는 것임
- 누군가가 구체적인 구현 클래스의 인스턴스를 직접 생성하여 본인이 지향하는 아키텍처 스타일을 위반하게 될 수 있음

### 조직화 vs 캡슐화
- 계층기반 패키지, 기능기반 패키지, 포트와 어댑터, 컴포넌트 기반 패키지 접근법으로 설명
- 모노리틱 애플리케이션에 대한 설명임
- 아키텍처 원칙을 강제할 때 규율이나 컴파일 후처리 도구를 이용하지 말고, 반드시 컴파일러에 의지할 것을 권장

### 다른 결합 분리 모드
- 자바에는 SGI같은 모듈 프레임워크나, java9에서 제공하는 새로울 모듈 시스템
- 이를 사용하면 public타입과 외부에 공표할 타입을 분리할 수 있음

####
- 업무와 도메인용 소스 코드: OrderSerivce, OrdersServiceImpl, Orders
- 웹용 소스 코드: OrdersController
- 데이터 영속성용 소스 코드: JdbcOrderRepository
- maven, gradle 같은 도구로 서로 분리되도록 구성해야함
- contoller와 repository는 컴파일 시점에서 업무와 도메인용 소스코드에 의존성을 가지며 업무와 도메인용 소스코드는 웹, 데이터 영속성 코드에 대해서 알지 못함
- 나누다 보면 성능, 복잡성, 유지보수가 어려움. -> 내부(도메인 코드), 외부(인프라 코드) 코드로 나누는 것

####
- 인프라는 도메인에 대해 컴파일 시점에 의존성을 가짐
- 포트와 어댑터에 대한 페리페리크 안티패턴임
- 인프라 코드를 단일 ㅗ스 코드에 모아둔다는 말은 애플리케이션에서 특정 영역(웹 컨트롤러)에 있는 인프라 코드가 애플리케이션의 다른 영역(데이터베이스 레포지터리)에 있는 코드를 직접 호출할 수 있다는 말.(도메인을 통하지 않고)
- 적절한 접근 지시자를 사용해야함
